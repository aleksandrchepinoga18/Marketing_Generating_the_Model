# Marketing_Generating_the_Model
Анализ данных клиентов компании Fix Price с использованием методов машинного обучения


# Анализ данных клиентов компании Fix Price с использованием методов машинного обучения

## Описание проекта
Проект представляет собой анализ данных клиентов компании Fix Price с использованием методов машинного обучения для классификации клиентов на основе их демографических данных, покупательского поведения и других характеристик. Основная цель — сегментировать клиентов на группы для улучшения маркетинговых стратегий и повышения эффективности продаж. Мы провели обучение модели для внедрения системы анализа маркетинговой активности продаж компании, что позволит лучше понимать поведение клиентов и оптимизировать маркетинговые кампании.

## Используемые библиотеки
- **Pandas** и **NumPy** для работы с данными.
- **Scikit-learn** для машинного обучения:
  - `train_test_split` для разделения данных на обучающую и тестовую выборки.
  - `RandomForestClassifier` для создания модели случайного леса.
  - `GridSearchCV` для поиска оптимальных гиперпараметров.
  - `KNeighborsClassifier` для метода k-ближайших соседей (k-NN).
  - `PCA` и `TSNE` для уменьшения размерности данных.
  - `StandardScaler` для масштабирования данных.
  - Метрики: `accuracy_score`, `classification_report`, `confusion_matrix`.
- **Seaborn** и **Matplotlib** для визуализации данных.

## Основные шаги
1. **Загрузка данных**:
   - Данные загружаются и содержат информацию о клиентах, включая их доход, количество покупок, демографические данные и другие характеристики.

2. **Предобработка данных**:
   - Разделение данных на признаки (`features`) и целевую переменную (`labels`).
   - Разделение данных на обучающую и тестовую выборки (`train_test_split`).

3. **Поиск оптимальных гиперпараметров для модели случайного леса**:
   - Использование `GridSearchCV` для настройки гиперпараметров модели случайного леса.
   - Получение лучших параметров: `{'criterion': 'gini', 'max_depth': None, 'max_features': 'sqrt', 'min_samples_split': 3, 'n_estimators': 50}`.

4. **Обучение и оценка модели случайного леса**:
   - Создание и обучение модели с оптимальными параметрами.
   - Оценка точности модели на тестовой выборке: **Accuracy: 0.859**.

5. **Анализ важности признаков**:
   - Определение наиболее важных признаков с помощью `feature_importances_`.
   - Визуализация важности признаков.

6. **Обучение и оценка модели k-NN**:
   - Использование только важных признаков для обучения модели k-NN.
   - Оценка точности модели: **Accuracy: 0.846**.

7. **Визуализация данных**:
   - Использование t-SNE и PCA для уменьшения размерности данных и визуализации.
   - Построение графиков для истинных и предсказанных меток.

## Результаты
- Модель случайного леса показала точность **85.9%** на тестовой выборке.
- Модель k-NN показала точность **84.6%** на тестовой выборке.
- Определены наиболее важные признаки, такие как `Recency`, `Customer_Days`, `AcceptedCmpOverall`, `MntRegularProds`, `Income`.

## Применение модели
- Модель может быть использована для сегментации клиентов и улучшения маркетинговых стратегий.
- Анализ важности признаков помогает понять, какие факторы наиболее значимы для предсказания поведения клиентов.
- Визуализация данных позволяет лучше понять структуру данных и точность классификации.
## Заключение
- Проект демонстрирует применение методов машинного обучения для анализа данных клиентов и классификации их поведения. Результаты могут быть использованы для улучшения маркетинговых стратегий и повышения эффективности взаимодействия с клиентами.

## Дополнительно 
- Надо сделать баланс классов и применить другие алгоритмы классификации, для того чтобы поднять показатели 

## Пример кода
```python
# Пример обучения модели случайного леса
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import GridSearchCV

# Оптимальные параметры
best_params = {
    'criterion': 'gini',
    'max_depth': None,
    'max_features': 'sqrt',
    'min_samples_split': 3,
    'n_estimators': 50
}

# Создание и обучение модели
rf_model = RandomForestClassifier(**best_params, random_state=5)
rf_model.fit(X_train, y_train)

# Предсказание и оценка
y_pred = rf_model.predict(X_test)
accuracy = metrics.accuracy_score(y_test, y_pred)
print("Accuracy:", accuracy)
